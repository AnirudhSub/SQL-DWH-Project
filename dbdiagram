// Use DBML to define your database structure
// Docs: https://dbml.dbdiagram.io/docs

// Use DBML to define your database structure
// Docs: https://dbml.dbdiagram.io/docs

Table CDW_SAPP_D_SUPPLIER {
  SUPPLIER_ID NUMBER
  SUPPLIER_NAME varchar
  SUPPLIER_SSN  NUMBER
  SUPPLIER_PHONE varchar
  SUPPLIER_LOC varchar
  LOADING_DATE timestamp
  SOURCE_DATA varchar
}

Table CDW_SAPP_D_CUSTOMER {
  CUST_ID number
  CUST_F_NAME varchar
  CUST_M_NAME varchar
  CUST_L_NAME varchar
  CUST_SSN number
  CUST_STREET varchar
  CUST_COUNTRY varchar
  CUST_ZIP number
  CUST_PHONE varchar
  CUST_EMAIL varchar
  CREATED_DATE timestamp
  END_DATE date
  LOADING_DATE timestamp
  SOURCE_DATA varchar
}

Table CDW_SAPP_D_Product {
  PRODUCT_CODE Number
  PRODUCT_NAME varchar
  SUPPLIER_ID number 
  PRODUCT_PRICE varchar
  LOADING_DATE timestamp
  SOURCE_DATA varchar
}

Table CDW_SAPP_D_BRANCH {
  BRANCH_CODE number
  BRANCH_NAME varchar
  BRANCH_STREET varchar
  BRANCH_CITY varchar
  BRANCH_STATE varchar
  BRANCH_ZIP number
  BRANCH_PHONE varchar
  LOADING_DATE timestamp
  SOURCE_DATA varchar
}

Table CDW_SAPP_D_TIME {
  TIMEID varchar
  DAY number
  MONTH number
  QUARTER varchar
  YEAR number
  LOADING_DATE timestamp
  SOURCE_DATA varchar
}

TABLE CDW_SAPP_STG_SALES {
  CDW_P_SALES_DSET_KEY number
  SALES_F_PERIOD_KEY date
  SALES_F_CUSTOMER_KEY NUMBER
  SALES_F_SUPPLIER_KEY NUMBER
  SALES_F_BRANCH_CODE NUMBER
  SALES_F_BRANCH_NAME varchar
  SALES_F_PRODUCT_CODE number
  SALES_F_PRODUCT_NAME varchar
  SALES_SOLD_QTY NUMBER
  SALES_TOTAL_AMOUNT NUMBER
  CREATED_DATE timestamp
  CREATED_BY varchar
}

Table CDW_SAPP_F_SALES {
  CDW_P_SALES_DSET_KEY number
  SALES_F_PERIOD_KEY date
  SALES_F_CUSTOMER_KEY NUMBER
  SALES_F_SUPPLIER_KEY NUMBER
  SALES_F_BRANCH_CODE NUMBER
  SALES_F_BRANCH_NAME varchar
  SALES_F_PRODUCT_CODE number
  SALES_F_PRODUCT_NAME varchar
  SALES_SOLD_QTY NUMBER
  SALES_TOTAL_AMOUNT NUMBER
  LOADING_DATE timestamp
  SOURCE_DATA varchar
}

Table CDW_SAPP_F_AGG_DATA {
  CDW_SALES_AGG_DSET number
  BRANCH_CODE number 
  BRANCH_NAME varchar
  PRODUCT_CODE number
  PRODUCT_NAME varchar
  TOTAL_QUANTITY number
  TOTAL_AMOUNT number
  CREATED_DATE date
}
ref {
  CDW_SAPP_D_BRANCH.BRANCH_CODE - CDW_SAPP_STG_SALES.SALES_F_BRANCH_CODE
}

ref {
  CDW_SAPP_D_CUSTOMER.CUST_ID - CDW_SAPP_STG_SALES.SALES_F_CUSTOMER_KEY
}

ref {
  CDW_SAPP_D_SUPPLIER.SUPPLIER_ID - CDW_SAPP_STG_SALES.SALES_F_SUPPLIER_KEY
}

ref {
  CDW_SAPP_D_TIME.TIMEID - CDW_SAPP_STG_SALES.SALES_F_PERIOD_KEY
}

ref {
  CDW_SAPP_D_Product.PRODUCT_CODE - CDW_SAPP_STG_SALES.SALES_F_PRODUCT_CODE
}

ref {
  CDW_SAPP_STG_SALES.CDW_P_SALES_DSET_KEY - CDW_SAPP_F_SALES.CDW_P_SALES_DSET_KEY
}

ref {
    CDW_SAPP_STG_SALES.SALES_F_PERIOD_KEY - CDW_SAPP_F_SALES.SALES_F_PERIOD_KEY
}

ref {
    CDW_SAPP_STG_SALES.SALES_F_CUSTOMER_KEY - CDW_SAPP_F_SALES.SALES_F_CUSTOMER_KEY
}
ref {
    CDW_SAPP_STG_SALES.SALES_F_SUPPLIER_KEY - CDW_SAPP_F_SALES.SALES_F_SUPPLIER_KEY
}
ref {
    CDW_SAPP_STG_SALES.SALES_F_BRANCH_CODE - CDW_SAPP_F_SALES.SALES_F_BRANCH_CODE
}
ref {
    CDW_SAPP_STG_SALES.SALES_F_BRANCH_NAME - CDW_SAPP_F_SALES.SALES_F_BRANCH_NAME
}

ref {
    CDW_SAPP_STG_SALES.SALES_F_PRODUCT_CODE - CDW_SAPP_F_SALES.SALES_F_PRODUCT_CODE
}
ref {
    CDW_SAPP_STG_SALES.SALES_F_PRODUCT_NAME - CDW_SAPP_F_SALES.SALES_F_PRODUCT_NAME
}
ref {
    CDW_SAPP_STG_SALES.SALES_SOLD_QTY - CDW_SAPP_F_SALES.SALES_SOLD_QTY
}
ref {
    CDW_SAPP_STG_SALES.SALES_TOTAL_AMOUNT - CDW_SAPP_F_SALES.SALES_TOTAL_AMOUNT
}

ref {
    CDW_SAPP_F_SALES.SALES_F_BRANCH_CODE - CDW_SAPP_F_AGG_DATA.BRANCH_CODE
}

ref {
    CDW_SAPP_F_SALES.SALES_F_BRANCH_NAME - CDW_SAPP_F_AGG_DATA.BRANCH_NAME
}

ref {
    CDW_SAPP_F_SALES.SALES_F_PRODUCT_CODE - CDW_SAPP_F_AGG_DATA.PRODUCT_CODE
}

ref {
    CDW_SAPP_F_SALES.SALES_F_PRODUCT_NAME - CDW_SAPP_F_AGG_DATA.PRODUCT_NAME
}

ref {
    CDW_SAPP_F_SALES.SALES_SOLD_QTY > CDW_SAPP_F_AGG_DATA.TOTAL_QUANTITY
}

ref {
  CDW_SAPP_F_SALES.SALES_TOTAL_AMOUNT > CDW_SAPP_F_AGG_DATA.TOTAL_AMOUNT
}

